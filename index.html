<html>
<head>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/snap.svg/0.4.1/snap.svg-min.js"></script> 
	<script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>
	<script type="text/javascript" charset="utf-8" src="lib/foundation.min.js"></script>
	<script type="text/javascript" charset="utf-8" src="lib/bootstrap-datepicker.js"></script>
	
	<link rel="stylesheet" type="text/css" media="all" href="css/foundation.min.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
	<link rel="stylesheet" type="text/css" id="bsdp-css" href="css/datepicker3.css">

	<title>Swish 2.0: NBA shot charts by Austin Clemens</title>
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
	<meta name="keywords" content="NBA shot charts">
	<meta name="description" content="Interactive NBA shot chart app with support for players, teams, and complex filtering. Updated nightly.">
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:site" content="@austinclemens2">
	<meta name="twitter:creator" content="@austinclemens2">
	<meta name="twitter:title" content="Interactive NBA Shot Charts">
	<meta name="twitter:description" content="Swish: Interactive NBA shot chart app with support for players, teams, and complex filtering.">
	<meta name="twitter:image:src" content="http://www.austinclemens.com/shotcharts/twitcard.png">
</head>

<style>
@import url(https://fonts.googleapis.com/css?family=Raleway:400,500,600);
@import url(https://fonts.googleapis.com/css?family=Abel:400,700);
@import url(https://fonts.googleapis.com/css?family=PT+Sans:400,700);

html {-webkit-font-smoothing: antialiased;}
h2 {font-family:PT Sans;font-weight:500;font-size:1.2em;line-height:1;color:white;margin:0;padding:0;}
h3 {font-size:1.2em;margin-top:6;font-family:Raleway;font-weight:700;}
a {color:white;}
a:hover {text-decoration:underline;color:white;}
select{padding-top:0;padding-bottom:0;margin:0;padding-left:15;}
body {background-color:#eef0f0;}

#spinner {position:absolute}

.head {position:absolute;font-family:Abel;font-weight:700;font-size:4.9em;color:white;margin-top:-.32em;padding:0;}
.maxwidth {max-width:940}
.banner {background-color:#b27300;border-bottom:1px solid black;border-top:1px solid #b27300;margin:0;height:4em;}
.fullWidth {width: 100%;margin-left: auto;margin-right: auto;padding:0;}
.banner_subnav {top:0em;float:none;position:relative;text-align:left;margin-bottom:1em;}
.banner_subnav li {float:none;display:inline-block;background:rgba(150, 150, 150, 0.5);border-radius: 0px 0px 3px 3px;}
.banner_subnav li a {padding:7 15 7 15;color:#000;display:block;font-size:1em;font-family:Raleway;}
.banner_subnav li.is-active {background:rgba(178, 115, 0, 0.5);border-radius: 0px 0px 3px 3px;}
.banner_subnav li:not(.is-active):hover {background:rgba(178, 115, 0, 0.5);border-radius: 0px 0px 3px 3px;}
.tab-content {display:none;}
.tab-content.is-active {display:inline;}
.under {text-decoration:underline;}
.footer {width:100%;height:7em;position:absolute;background-color:#b27300;margin-top:5em;color:white;padding-top:1.3em;border-top:1px solid black}
.button {background-color:#b27300;border-radius:2px;margin-top:10px;}
.button:hover {background-color:#705201;}
.fa {margin-right:6px;}
.input-group-label {padding6;text-align:left;}
.input-group-field {border-radius:0px;padding-top:0;padding-bottom:0;margin:0;}
.datepicker table tr td, .datepicker table tr th {border-radius:0px;}
.noborder {border-left:0;border-right:0;}
.white {color:white;}
.white:hover {color:white;}
.white:active {color:white;}
.white:visited {color:white;}
.left {border-radius:3px 0px 0px 3px;margin:0;margin-bottom:1.5em;margin-right:1px;}
.middle {border-radius: 0px 0px 0px 0px;margin:0;margin-bottom:1.5em;}
.right {border-radius:0px 3px 3px 0px;margin:0;margin-bottom:1.5em;margin-left:1px;}
.top {position:absolute;padding-left:20em;padding-top:1.4em;}
.fa-twitter:hover {color:#7EB3CD;}
.current {text-decoration:underline;}
.navigation {font-family:PT Sans;font-weight:500;font-size:1.2em;line-height:1;color:white;margin:0;padding-top:3em;margin-top:3em;}
.pipe {padding-left:10px;padding-right:10px;font-family:PT Sans;font-weight:500;font-size:1.2em;line-height:1;color:white;;padding-top:3em;margin-top:3em}
</style>

<body>

<header class='banner fullWidth'>
	<div class='row'>
		<div class='small-12 columns'>
			<span class='head'>Swish 2.0</span>
			<div class='top'>
				<span class='navigation'>NBA</span><span class='pipe'>|</span>
				<span class='navigation'>WNBA</span><span class='pipe'>|</span>
				<span class='navigation'>D-League</span><span class='pipe'>|</span>
				<span class='navigation'><i class="fa fa-twitter fa-inverse"></i>austinclemens2</span>
			</div>
	</div>
</header>

<div class='row'>
	<div class='small-12 columns'>
		<ul class="banner_subnav">
			<li class="is-active" data-tab='players'><a href="#players">Player Shotcharts</a></li>
			<li data-tab='teams'><a href="#teams">Team Shotcharts</a></li>
		</ul>
	</div>
</div>

<div class='row'>
	<div class='small-12 columns text-center'>
		<svg id="court" class='maxwidth' viewBox='-20 17 940 667'></svg>
	</div>
</div>
<div class='row'>
	<div class='small-12 columns text-center'><br>
	</div>
</div>

<div class='row'>
	<div class='small-12 small-centered columns text-center'>
		<button class="button left" onchange='kobe_me' href="#"><i class="fa fa-trophy"></i>Kobe me</button><button class="button middle" onclick='load_chart()' href="#"><i class="fa fa-refresh"></i>Chart it</button><button class="button right" href="#"><i class="fa fa-download"></i>Download</button>
	</div>
</div>

<div id='players' class='tab-content is-active'>
	<div class='row'>
		<div class='small-12 columns'>
			<h3>Choose a season and a player</h3>
		</div>
	</div>

	<div class='row'>
		<div class='small-4 columns'>
			<div class='input-group'>
				<span class='input-group-label'>Season</span>
				<select id='year_select'>
				</select>
			</div>
		</div>

		<div class='small-4 columns'>
			<div class='input-group'>
				<span class='input-group-label'>Type</span>
				<select id='type_select'>
					<option>Regular Season</option>
					<option>Playoffs</option>
		 			<option>All Star</option>
				</select>
			</div>
		</div>

		<div class='small-4 columns'>
			<div class='input-group'>
				<span class='input-group-label'>Player</span>
				<select id='player_select'>
				</select>
			</div>
		</div>
		<div class='small-6 columns'>
		</div>
	</div>

	<div class='row'>
		<div class='small-12 columns'>
			<h3>Choose game quarter and date range (optional)</h3>
		</div>
	</div>

	<div class='row'>
		<div class='small-4 columns'>
			<div class='input-group'>
				<span class='input-group-label'>Quarter</span>
				<select id='quarter select'>
					<option value='all'>Complete Game</option>
					<option value="1">1st quarter</option>
					<option value="2">2nd quarter</option>
					<option value="3">3rd quarter</option>
					<option value="4">4th quarter</option>
					<option value="last4">Last 4 minutes</option>
				</select>
			</div>
		</div>

		<div class='small-4 columns'>
			<div class='input-group input-daterange'>
				<input type="text" class="input-group-field" id='date1'>
				<span class='input-group-label noborder'>to</span>
				<input type="text" class="input-group-field" id='date2'>
			</div>
		</div>

		<div class='small-4 columns'>
		</div>
	</div>
</div>



<div id='teams' class='tab-content'>
	<div class='row'>
		<div class='small-12 columns'>
			<h3>Choose a season and a team</h3>
		</div>
	</div>

	<div class='row'>
		<div class='small-4 columns'>
			<div class='input-group'>
				<span class='input-group-label'>Season</span>
				<select id='year_select'>
				</select>
			</div>
		</div>

		<div class='small-4 columns'>
			<div class='input-group'>
				<span class='input-group-label'>Type</span>
				<select>
					<option value="regular">Regular Season</option>
					<option value="playoff">Playoffs</option>
		 			<option value="allstar">All Star</option>
				</select>
			</div>
		</div>

		<div class='small-4 columns'>
			<div class='input-group'>
				<span class='input-group-label'>Team</span>
				<select id='team_select'>
				</select>
			</div>
		</div>
		<div class='small-6 columns'>
		</div>
	</div>

	<div class='row'>
		<div class='small-12 columns'>
			<h3>Choose game quarter, date range, and offense or defense</h3>
		</div>
	</div>

	<div class='row'>
		<div class='small-4 columns'>
			<div class='input-group'>
				<span class='input-group-label'>Quarter</span>
				<select>
					<option value='all'>Complete Game</option>
					<option value="1">1st quarter</option>
					<option value="2">2nd quarter</option>
					<option value="3">3rd quarter</option>
					<option value="4">4th quarter</option>
					<option value="last4">Last 4 minutes</option>
				</select>
			</div>
		</div>

		<div class='small-4 columns'>
			<div class='input-group input-daterange'>
				<input type="text" class="input-group-field" id='date3'>
				<span class='input-group-label noborder'>to</span>
				<input type="text" class="input-group-field" id='date4'>
			</div>
		</div>

		<div class='small-4 columns'>
			<div class='input-group'>
				<span class='input-group-label'>Side</span>
				<select>
					<option value="1">Offense</option>
					<option value="0">Defense</option>
				</select>
			</div>
		</div>
	</div>

</div>






<div class='footer'>
	<div class='row'>
		<div class='small-1 columns'>
		</div>
		<div class='small-9 columns'>
			<p>Â© <a href='http://www.austinclemens.com/blog'>Austin Clemens</a><br>
			All data is from the <a href='http://stats.nba.com'>National Basketball Association</a>.</p>
		</div>
		<div class='small-2 columns text-left'>
			<p><a href='http://www.austinclemens.com/blog' class='white'><i class='fa fa-link fa-inverse'></i>Web</a><br>
			<a href='http://www.twitter.com/austinclemens2' class='white'><i class="fa fa-twitter fa-inverse"></i>Twitter</a><br>
			<a href='mailto:austinc@mac.com?Subject=Swish' class='white'><i class="fa fa-envelope fa-inverse"></i>Email</a></p>
		</div>
	</div>
</div>

</body>

<script defer>
var active_tab='players'

// handle subnav tabs
$(document).ready(function(){
	$('ul.banner_subnav li').click(function(){
		active_tab = $(this).attr('data-tab');

		$('ul.banner_subnav li').removeClass('is-active');
		$('.tab-content').removeClass('is-active');
		$(this).addClass('is-active');
		$("#"+active_tab).addClass('is-active');
	})
})

// initialize dates
var m = new Date();
if (m.getUTCDate()>10){day=m.getUTCDate()}else{day='0'+m.getUTCDate()}
var dateString = day +"/"+("0" + (m.getUTCMonth()+1)).slice(-2) +"/"+("0" + m.getUTCFullYear()).slice(-4)

$('#date1').attr('value',dateString)
$('#date2').attr('value',dateString)
$('#date3').attr('value',dateString)
$('#date4').attr('value',dateString)

$('.input-daterange input').each(function() {
    $(this).datepicker({
		format: "mm/dd/yyyy",
		todayHighlight: true
    });
});

// update player dropdown
$("#year_select").change(function() {
	var year=$( "#year_select" ).val()
	$("#player_select").empty()

	$.ajax({
		url: "nba_menus/players_"+year+".csv",
		success: function(response){
			response=response.split(/\r\n|\n/)

			for (var i=0; i<response.length;i++) {
				row=response[i].split(',')
				try{$('#player_select').append(new Option(row[1].replace(/"/g,'')));}catch(err){}
			}
		}
	});
})

// update team dropdown
$("#team_select").change(function() {
	var year=$( "#year_select" ).val()
	$("#team_select").empty()

	$.ajax({
		url: "nba_menus/teams_"+year+".csv",
		success: function(response){
			response=response.split(/\r\n|\n/)

			for (var i=0; i<response.length;i++) {
				row=response[i].split(',')
				try{$('#team_select').append(new Option(row[1].replace(/"/g,'')));}catch(err){}
			}
		}
	});
})

// chart loading
function load_chart(){
	if (active_tab=='players'){
		season=$("#year_select").val()
		type=$("#type_select").val()
		player=$("#player_select").val()
		quarter=$("#quarter_select").val()
		startdate=$("#startdate_select").val()
		enddate=$("#enddate_select").val()

	    dict={chart_type:'1',player1:player,year:season.toString(),season:type,efficiency:'FG'}
	    load_pshotnew(dict)
	}

	if (active_tab=='teams'){
		season=$("#tyear_select").val()
		type=$("#ttype_select").val()
		player=$("#team_select").val()
		quarter=$("#tquarter_select").val()
		startdate=$("#tstartdate_select").val()
		enddate=$("#tenddate_select").val()
		side=$("#tside_select").val()

	    dict={chart_type:'3',player1:player,year:year,season:type,quarter:quarter,startdate:startdate,enddate:enddate,side:side}
		console.log(dict)
	    load_pshotnew(dict)
	}
}

// initialize snap and first drawing
var court = Snap("#court")
draw_base()
tag_court()
draw_key()
// fake_details()

function draw_base() {
	if (typeof courtlines!="undefined") {
		courtlines.clear()
	}

	// lines and rects
	var graph_box=court.rect(-30,-20,1100,1000).attr({fill:'#eef0f0'})
	var credit_box=court.rect(-30,664,1100,20).attr({fill:'#606060'})
	// var details_box=court.rect(0,30,900,20).attr({fill:'#606060'})
	var key_outer_left=court.line(306,50,306,392).attr({'shape-rendering':'crispEdges'})
	var key_outer_right=court.line(594,50,594,392).attr({'shape-rendering':'crispEdges'})
	var key_inner_left=court.line(342,50,342,392).attr({'shape-rendering':'crispEdges'})
	var key_inner_right=court.line(558,50,558,392).attr({'shape-rendering':'crispEdges'})
	var key_top=court.line(306,392,594,392).attr({'shape-rendering':'crispEdges'})
	var baseline_tick_left=court.line(252,50,252,59).attr({'shape-rendering':'crispEdges'})
	var baseline_tick_right=court.line(648,50,648,59).attr({'shape-rendering':'crispEdges'})
	var ft_tick_left=court.line(360,284,369,284).attr({'shape-rendering':'crispEdges'})
	var ft_tick_right=court.line(540,284,531,284).attr({'shape-rendering':'crispEdges'})
	var backboard=court.line(396,120.2,504,120.2).attr({'shape-rendering':'crispEdges'})
	var nocharge_tick_left=court.line(378,125.6,378,148.1).attr({'shape-rendering':'crispEdges'})
	var nocharge_tick_right=court.line(522,125.6,522,148.1).attr({'shape-rendering':'crispEdges'})
	var key_left_tick1=court.line(306,176,292.5,176).attr({'shape-rendering':'crispEdges'})
	var key_right_tick1=court.line(594,176,607.5,176).attr({'shape-rendering':'crispEdges'})
	var key_left_tick2=court.line(306,194,292.5,194).attr({'shape-rendering':'crispEdges'})
	var key_right_tick2=court.line(594,194,607.5,194).attr({'shape-rendering':'crispEdges'})
	var key_left_tick3=court.line(306,248,292.5,248).attr({'shape-rendering':'crispEdges'})
	var key_right_tick3=court.line(594,248,607.5,248).attr({'shape-rendering':'crispEdges'})
	var key_left_tick4=court.line(306,302,292.5,302).attr({'shape-rendering':'crispEdges'})
	var key_right_tick4=court.line(594,302,607.5,302).attr({'shape-rendering':'crispEdges'})
	var left_threeline=court.line(54,50,54,306).attr({'shape-rendering':'crispEdges'})
	var right_threeline=court.line(846,50,846,306).attr({'shape-rendering':'crispEdges'})
	var baseline=court.line(0,50,900,50).attr({'shape-rendering':'crispEdges','stroke-width':2})

	// arcs
	var three_arc=court.path("M54,305A427.5,427.5 1 0,0 846,305")
	var inner_ft_circle=court.path("M342,392A108,108 1 0,1 558,392").attr({ "stroke-dasharray" : [22.5,22.5]});
	var outer_ft_circle=court.path("M342,392A108,108 1 0,0 558,392")
	var hoop=court.circle(450,134.6,13.5)
	var nocharge=court.path("M378,148.1A72,72 1 0,0 522,148.1")

	//zones
	left3zone=court.line(0,306,50,306).attr({'stroke-dasharray':[6,6],'stroke-width':1,stroke:'#000',opacity:.1,'shape-rendering':'crispEdges'})
	right3zone=court.line(846,306,896,306).attr({'stroke-dasharray':[6,6],'stroke-width':1,stroke:'#000',opacity:.1,'shape-rendering':'crispEdges'})
	longleftzone=court.line(50,306,306,306).attr({'stroke-dasharray':[6,6],'stroke-width':1,stroke:'#000',opacity:.1,'shape-rendering':'crispEdges'})
	longrightzone=court.line(594,306,846,306).attr({'stroke-dasharray':[6,6],'stroke-width':1,stroke:'#000',opacity:.1,'shape-rendering':'crispEdges'})
	longcenterzone1=court.line(306,392,306,545).attr({'stroke-dasharray':[6,6],'stroke-width':1,stroke:'#000',opacity:.1,'shape-rendering':'crispEdges'})
	longcenterzone1=court.line(594,392,594,545).attr({'stroke-dasharray':[6,6],'stroke-width':1,stroke:'#000',opacity:.1,'shape-rendering':'crispEdges'})
	leftarc=court.line(246,522,186,664).attr({'stroke-dasharray':[6,6],'stroke-width':1,stroke:'#000',opacity:.1,'shape-rendering':'crispEdges'})
	rightarc=court.line(654,522,714,664).attr({'stroke-dasharray':[6,6],'stroke-width':1,stroke:'#000',opacity:.1,'shape-rendering':'crispEdges'})

	// grouping and applying attributes
	courtlines=court.group(key_outer_left,key_outer_right,key_inner_left,key_inner_right,key_top,baseline_tick_left,baseline_tick_right,ft_tick_left,ft_tick_right,backboard,nocharge_tick_left,nocharge_tick_right,key_left_tick1,key_left_tick2,key_left_tick3,key_left_tick4,key_right_tick1,key_right_tick2,key_right_tick3,key_right_tick4,left_threeline,right_threeline,three_arc,inner_ft_circle,outer_ft_circle,hoop,nocharge,baseline)
	courtlines.attr({stroke: "#000",fill: "none",strokeWidth:1})

	// spinner
	Snap.load("spin.svg", function (f) {
		g = f.select("g");
		g.attr({transform:'t450 340'})
		g.attr({opacity: 0});
		court.append(g)
	})
}

function tag_court() {
	var twitlink=court.text(910,678,"@AustinClemens2").attr({fontFamily:"Abel",fontSize:13,fill:'white','font-weight':500,'text-anchor':'end',cursor:'pointer'})
	coords=twitlink.getBBox()
	twitlink.click(function() {window.location="https://twitter.com/austinclemens2"})
	var bird=court.image("Twitter_logo_sm.png",coords.x,667.5,16,13)

	court.text(-10,678,"www.austinclemens.com/shotcharts").attr({fontFamily:"Abel",fontSize:13,fill:'white','font-weight':500})
}

function head(name,details) {
	var name=court.text(0,47,name).attr({id:'temp',fontFamily:"Raleway",fontSize:33,fill:"#505050",'text-anchor':'start','font-weight':600})
	coords=name.getBBox()
	court.text(coords.x2+15,47,details).attr({id:'temp',fontFamily:"Abel",fontSize:15,fill:'black','text-anchor':'start'})
}

function draw_key() {
	// color key
	var grad=court.gradient('l()'+choosecolor(-.1)+'-'+choosecolor(-.07)+'-'+choosecolor(-.04)+'-'+choosecolor(-.01)+'-'+'#ffffff'+'-'+choosecolor(.01)+'-'+choosecolor(.04)+'-'+choosecolor(.07)+'-'+choosecolor(.1))
	var keybox=court.rect(748,640,128,18,2).attr({fill:grad,'shape-rendering':'crispEdges'})
	var keytext2=court.text(743,648,"Below").attr({fontFamily:"Abel",fontSize:11,'text-anchor':'end'})
	var keytext2=court.text(743,658,"Average").attr({fontFamily:"Abel",fontSize:11,'text-anchor':'end'})
	var keytext3=court.text(881,648,"Above").attr({fontFamily:"Abel",fontSize:11,'text-anchor':'start'})
	var keytext3=court.text(881,658,"Average").attr({fontFamily:"Abel",fontSize:11,'text-anchor':'start'})
	var divider=court.line(812,640,812,658).attr({'shape-rendering':'crispEdges',stroke:'black','stroke-width':1,opacity:.3})

	// size key
	var keybox2_1=court.rect(17, 645, 8, 8, 2).attr({fill:choosecolor(.04),strokeWidth:0,'shape-rendering':'crispEdges'})
	var keybox2_2=court.rect(29, 642, 13, 13, 2).attr({fill:choosecolor(.04),strokeWidth:0,'shape-rendering':'crispEdges'})
	var keybox2_3=court.rect(46, 639, 18, 18, 2).attr({fill:choosecolor(.04),strokeWidth:0,'shape-rendering':'crispEdges'})
	var keytext2=court.text(12,648,"Few").attr({fontFamily:"Abel",fontSize:11,'text-anchor':'end'})
	var keytext2=court.text(12,658,"Shots").attr({fontFamily:"Abel",fontSize:11,'text-anchor':'end'})
	var keytext3=court.text(69,648,"Many").attr({fontFamily:"Abel",fontSize:11,'text-anchor':'start'})
	var keytext3=court.text(69,658,"Shots").attr({fontFamily:"Abel",fontSize:11,'text-anchor':'start'})
}

window.onload=function() {
	// initialize season menu
	var year = m.getUTCFullYear()
	if(m.getUTCMonth()<7){year=year-1}
	for (var i=year-2000;i>=0;i--){
		$('#year_select').append(new Option(2000+i+'-'+(2001+i),2000+i));
	}
	$('#year_select').append(new Option('Career', 'Career'));
	$('#year_select').change();

    dict={chart_type:'1',player1:'Dirk Nowitzki',year:'2011',efficiency:'FG',season:'Regular Season'}
    load_pshotnew(dict)
}

function kobe_me() {
	
}

function load_pshotnew(dict) {
	// var target=document.getElementById('container')
	// var spinner=new Spinner(opts).spin(target)
	court.selectAll("[id='temp']").remove()
	court.append(g)
	g.animate({opacity: 1},500);
	console.log(dict)
	$.ajax({
	url: "http://www.austinclemens.com/cgi-bin/post_numpy.py",
	type: "post",
	datatype: "html",
	data:   dict,
	success: function(response){
		console.log(response)
		var shot_data = eval("(" + response + ")");
		drawcourt_pshot(shot_data)
		g.animate({opacity: 0},500);
	}
	});
}

function drawcourt_pshot(shot_data) {
	head(shot_data[shot_data.length-3],shot_data[shot_data.length-4])

	var max=shot_data[0][2]
	var min=shot_data[shot_data.length-5][2]

	var draws=200
	var max=shot_data[0][2]
	var min=shot_data[shot_data.length-5][2]

	for(var n = 0; n < draws; n++) {
		if (shot_data[n][2]>0 && shot_data[n][5]>0.005){
			var X = shot_data[n][1]*1.8+450+9 ;
  			var Y = shot_data[n][0]*1.8+144.5+9 ;
  			size=choosesize(shot_data[n][2],min,max,16)

  			var square_fg=court.rect(X,Y,0,0,2,2).attr({id:'temp',fill:choosecolor(shot_data[n][3]),stroke:'#999999',strokeWidth:0,'shape-rendering':'crispEdges'});
  			square_fg.animate({x:X-(size/2),y:Y-(size/2),height:size,width:size},1500,mina.bounce)
  		}
	}
}

function choosecolor(per) {
	if (per>.09) return '#d73027';
	if (per>.06 && per<=.09) return '#f46d43';
	if (per>.03 && per<=.06) return '#fdae61';
	if (per>=0 && per<=.03) return '#fee090';
	if (per<0 && per>=-.03) return '#bfe2ee';
	if (per<-.03 && per>=-.06) return '#abd9e9';
	if (per<-.06 && per>=-.09) return '#74add1';
	if (per<-.09) return '#4575b4';
}

function choosesize(shots,min,max,side_length) {
	if (shots==0) {return 0}
	if (min==0) {var min=1}

	var shots=Math.log(shots)
	var min=Math.log(min)
	var max=Math.log(max)
	var fraction=(shots-min)/(max-min)
	var minsize=45
	var differential=(Math.pow(side_length,2)-minsize)
	var blah=Math.sqrt(fraction*differential+minsize)
	return Math.round(blah);
}

</script>

</body>
</html>